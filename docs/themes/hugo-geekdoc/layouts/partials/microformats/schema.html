{{ $isPage := or (and (ne .Type "posts") (in "section page" .Kind )) (and (eq .Type "posts") (eq .Kind "page")) }}
{{- if eq .Kind "home" }}
  {{- $schema := dict "@context" "http://schema.org" "@type" "WebSite" "name" .Site.Title "url" .Site.BaseURL "inLanguage" .Lang }}
  {{- with partial "utils/description" . }}
    {{- $schema = merge $schema (dict "description" (. | plainify | htmlUnescape | chomp)) }}
  {{- end }}
  {{- with partial "utils/featured" . }}
    {{- $schema = merge $schema (dict "thumbnailUrl" .) }}
  {{- end }}
  {{- with .Site.Params.geekdocContentLicense }}
    {{- $schema = merge $schema (dict "license" .name) }}
  {{- end }}
  <script type="application/ld+json">
  {{- $schema | jsonify | safeJS }}
  </script>
{{- else if $isPage }}
  {{- $title := partial "utils/title" . }}
  {{- $schema := dict
      "@context" "http://schema.org"
      "@type" "TechArticle"
      "articleSection" (.Section | humanize | title)
      "name" $title
      "url" .Permalink
      "headline" $title
      "wordCount" (string .WordCount)
      "inLanguage" .Lang
      "isFamilyFriendly" "true"
      "copyrightHolder" .Site.Title
      "copyrightYear" (.Date.Format "2006")
      "dateCreated" (.Date.Format "2006-01-02T15:04:05.00Z")
      "datePublished" (.PublishDate.Format "2006-01-02T15:04:05.00Z")
      "dateModified" (.Lastmod.Format "2006-01-02T15:04:05.00Z")
    }}
  {{- with .Params.lead }}
    {{- $schema = merge $schema (dict "alternativeHeadline" .) }}
  {{- end }}
  {{- with partial "utils/description" . }}
    {{- $schema = merge $schema (dict "description" (. | plainify | htmlUnescape | chomp)) }}
  {{- end }}
  {{- with partial "utils/featured" . }}
    {{- $schema = merge $schema (dict "thumbnailUrl" .) }}
  {{- end }}
  {{- with .Site.Params.geekdocContentLicense }}
    {{- $schema = merge $schema (dict "license" .name) }}
  {{- end }}
  {{- $mainEntity := dict "@type" "WebPage" "@id" .Permalink }}
  {{- $schema = merge $schema (dict "mainEntityOfPage" $mainEntity) }}
  {{- with $tags := .Params.tags }}
    {{- $schema = merge $schema (dict "keywords" $tags) }}
  {{- end }}
  {{- $logoUrl := default "brand.svg" .Site.Params.logo | absURL }}
  {{- $logo := dict "@type" "ImageObject" "url" $logoUrl "width" "32" "height" "32" }}
  {{- $publisher := dict "@type" "Organization" "name" .Site.Title "url" .Site.BaseURL "logo" $logo }}
  {{- $schema = merge $schema (dict "publisher" $publisher) }}
  <script type="application/ld+json">
  {{- $schema | jsonify | safeJS }}
  </script>
{{- end }}
